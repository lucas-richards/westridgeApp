{% extends "blog/base.html" %}
{% load crispy_forms_tags %}
{% block content %}

<div class="content-section ">
    <h2>Welcome to the Training Page</h2>
    <p >This is where you can find all the training materials you need to get started with Westridge Labs</p>
    <p >Please feel free to reach out to us if you have any questions or need further assistance</p>
</div>
{% if user.is_authenticated %}
<h2>Your Trainings:</h2>

{% for certificate, form in formswithcert %}
<div id="accordion" class="mb-3 card {% if certificate.status == 'Completed' %}bg-success-light{% endif %}">
    <div class="card-header" id="headingOne">
        <button  class="btn" data-toggle="collapse" data-target="#collapse{{ certificate.id }}" aria-expanded="true" aria-controls="collapseOne" style="font-size: 22px;">{{ certificate.certification.name }}
        {% if certificate.status != 'Completed' %}
            {% if certificate.is_past_due %}
                <small class="text-danger"> (Expired)</small>
            {% else %}
                <small class="text-success">  ({{ certificate.due_date|timeuntil }})</small>
            {% endif %}
        {% endif %}
        </button>
    </div>
    <div id="collapse{{ certificate.id }}" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
        <div class="card-body">
            <form action="{% url 'training-home' %}" method="POST">
                {% csrf_token %}
                    <div class="d-flex justify-content-between align-items-end" >
                        <input type="hidden" name="id" value="{{ certificate.id }}">
                        {{ form|crispy }}
                        <div class="form-group">
                            <button class="btn btn-outline-info" type="submit">Update</button>
                        </div>
                    </div>
            </form>
        </div>
    </div>
</div>
{% endfor %}



{% else %}
<a class="nav-item nav-link" href="{% url 'login' %}">Login</a>
<a class="nav-item nav-link" href="{% url 'register' %}">Register</a>
{% endif %}
    


{% endblock content %}