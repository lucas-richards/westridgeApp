{% extends "training/tabs_nav.html" %}
{% load crispy_forms_tags %}
{% block content %}

{% if user.is_authenticated %}

    {% if zip_data %}

    {% for module, index in zip_data %}
    <div id="accordion" class="m-3 card">
        <div class="card-header" id="headingOne">
            <h5>{{ module.name }}</h5>
        </div>
        <div class="card-body">
                {% for row in data %}
                    {% for event in row.training_events %}
                        {% if event.training_module == module %}
                            {% if event.status == 'Expired' %}
                                
                                <p>{{ row.username }} 
                                    <span class="badge badge-danger">Expired</span>
                                </p>
                            {% elif event.status == 'About to expire' %}
                                
                                <p>{{ row.username }} 
                                    <span class="badge badge-warning">{{ event.expiration_date|timeuntil }}</span>
                                </p>
                            {% else %}
                            {% endif %}
                        {% elif event == module.name %}
                        
                            <p>{{ row.username }} 
                                <span class="badge badge-secondary">Missing</span>
                            </p>
                        {% else %}
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </div>
    </div>
    {% endfor %}



    <!-- if there are no training_modules yet -->
    {% else %}
        <p class="m-3">No trainings yet</p>
    {% endif %}




{% endif %}
    


{% endblock content %}